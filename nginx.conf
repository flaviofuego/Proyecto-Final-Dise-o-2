 
events {
    worker_connections 1024;
}

http {
    upstream auth_service {
        server auth-service:8000;
    }
    
    upstream personas_service {
        server personas-service:8000;
    }
    
    upstream consultas_service {
        server consultas-service-1:8000;
        server consultas-service-2:8000;
    }
    
    upstream nlp_service {
        server nlp-service:8000;
    }
    
    upstream logs_service {
        server logs-service:8000;
    }
    
    server {
        listen 80;
        
        location / {
            root /usr/share/nginx/html;
            index index.html;
            try_files $uri $uri/ /index.html;
        }
        
        location /api/auth/ {
            proxy_pass http://auth_service/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        
        location /api/personas/ {
            proxy_pass http://personas_service/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        
        location /api/consultas/ {
            proxy_pass http://consultas_service/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        
        location /api/nlp/ {
            proxy_pass http://nlp_service/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        
        location /api/logs/ {
            proxy_pass http://logs_service/;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
    }
}
 